dbDisconnect(dbcon)
library(RSQLite)
library(sqldf)
# get current work directory
wd = getwd()
fpath = paste0(wd, "/")
dbfile = "MediaDB.db"
# create db or get db connection
dbcon <- dbConnect(RSQLite::SQLite(), paste0(fpath, dbfile))
sqlQuery <- 'SELECT * FROM invoice_items'
rs <- dbGetQuery(dbcon,sqlQuery)
rs$ExtPrice <- rs$Quantity * rs$UnitPrice
avg <- round(mean(rs$ExtPrice), 2)
rs
avg
sqlQuery <- 'SELECT * FROM invoice_items'
rs <- dbGetQuery(dbcon,sqlQuery)
rs$ExtPrice <- rs$Quantity * rs$UnitPrice
avg <- round(mean(rs$ExtPrice), 2)
rs
avg
sqlQuery <- 'SELECT * FROM invoice_items'
rs <- dbGetQuery(dbcon,sqlQuery)
rs$ExtPrice <- rs$Quantity * rs$UnitPrice
avg <- round(mean(rs$ExtPrice), 1)
rs
avg
sqlQuery <- 'SELECT * FROM invoice_items'
rs <- dbGetQuery(dbcon,sqlQuery)
rs$ExtPrice <- rs$Quantity * rs$UnitPrice
avg <- round(mean(rs$ExtPrice), 2)
rs
avg
sqlQuery <- 'SELECT * FROM invoice_items'
rs <- dbGetQuery(dbcon,sqlQuery)
rs$ExtPrice <- rs$Quantity * rs$UnitPrice
avg <- round(mean(rs$ExtPrice), 3)
rs
avg
sqlQuery <- 'SELECT * FROM invoice_items'
rs <- dbGetQuery(dbcon,sqlQuery)
rs$ExtPrice <- rs$Quantity * rs$UnitPrice
avg <- round(mean(rs$ExtPrice), 2)
rs
avg
sqlQuery <- 'SELECT * FROM invoice_items'
rs <- dbGetQuery(dbcon,sqlQuery)
rs$ExtPrice <- rs$Quantity * rs$UnitPrice
avg <- round(mean(rs$ExtPrice), 0)
rs
avg
sqlQuery <- 'SELECT * FROM invoice_items'
rs <- dbGetQuery(dbcon,sqlQuery)
rs$ExtPrice <- rs$Quantity * rs$UnitPrice
avg <- round(mean(rs$ExtPrice), 1)
rs
avg
sqlQuery <- 'SELECT * FROM invoice_items'
rs <- dbGetQuery(dbcon,sqlQuery)
rs$ExtPrice <- rs$Quantity * rs$UnitPrice
avg <- round(mean(rs$ExtPrice), 2)
rs
avg
sqlQuery <- 'SELECT * FROM invoice_items'
rs <- dbGetQuery(dbcon,sqlQuery)
rs$ExtPrice <- rs$Quantity * rs$UnitPrice
avg <- round(mean(rs$ExtPrice), 3)
rs
avg
sqlQuery <- 'SELECT * FROM invoice_items'
rs <- dbGetQuery(dbcon,sqlQuery)
rs$ExtPrice <- rs$Quantity * rs$UnitPrice
avg <- round(mean(rs$ExtPrice), 4)
rs
avg
sqlQuery <- 'SELECT * FROM invoice_items'
rs <- dbGetQuery(dbcon,sqlQuery)
rs$ExtPrice <- rs$Quantity * rs$UnitPrice
avg <- round(mean(rs$ExtPrice), 3)
rs
avg
sqlQuery <- 'SELECT * FROM invoice_items'
rs <- dbGetQuery(dbcon,sqlQuery)
rs$ExtPrice <- rs$Quantity * rs$UnitPrice
avg <- round(mean(rs$ExtPrice), 2)
rs
avg
sqlQuery <- 'SELECT * FROM invoice_items'
rs <- dbGetQuery(dbcon,sqlQuery)
rs$ExtPrice <- rs$Quantity * rs$UnitPrice
avg <- round(mean(rs$ExtPrice), 2)
rs
avg
sqlQuery <- 'SELECT * FROM invoice_items'
rs <- dbGetQuery(dbcon,sqlQuery)
rs$ExtPrice <- rs$Quantity * rs$UnitPrice
avg <- round(mean(rs$ExtPrice), 2)
rs
avg
rs2 <- sqldf('SELECT InvoiceId, SUM(ExtPrice) AS total, COUNT(*) AS num FROM rs
GROUP BY InvoiceId')
rs2
rs2 <- sqldf('SELECT InvoiceId, SUM(ExtPrice) AS total, COUNT(InvoiceLineId) AS num
FROM rs
GROUP BY InvoiceId')
rs2
rs2 <- sqldf('SELECT InvoiceId, SUM(ExtPrice) AS total, COUNT(*) AS num
FROM rs
GROUP BY InvoiceId')
rs2
rs2 <- sqldf('SELECT InvoiceId, SUM(ExtPrice) AS total, COUNT(*) AS num
FROM rs
GROUP BY InvoiceId')
rs2
xData <- rs2$num
yData <- rs2$total
# change point to shape 19, remove frame of plot
plot(xData, yData, main = 'Invoice Plot',
xlab = 'Number of Items', ylab = 'Total Amount',
pch = 19, frame = FALSE)
xData <- rs2$num
yData <- rs2$total
# change point to shape 19, remove frame of plot
plot(xData, yData, main = 'Invoice Plot',
xlab = 'Number of Items', ylab = 'Total Amount',
pch = 19, frame = FALSE)
rs2 <- sqldf('SELECT InvoiceId, SUM(ExtPrice) AS total, COUNT(*) AS num
FROM rs
GROUP BY InvoiceId')
rs2
xData <- rs2$num
yData <- rs2$total
# change point to shape 19, remove frame of plot
plot(xData, yData, main = 'Invoice Plot',
xlab = 'Number of Items', ylab = 'Total Amount',
pch = 19, frame = FALSE)
alterStatement <- 'ALTER TABLE invoices DROP COLUMN DiscPrice'
dbExecute(dbcon, alterStatement)
alterStatement <- 'ALTER TABLE invoices DROP COLUMN DiscPrice'
dbExecute(dbcon, alterStatement)
alterStatement <- 'ALTER TABLE invoices DROP COLUMN IF EXISTS DiscPrice'
dbExecute(dbcon, alterStatement)
alterStatement <- 'ALTER TABLE invoices DROP COLUMN IF EXISTS DiscPrice'
dbExecute(dbcon, alterStatement)
alterStatement <- 'ALTER TABLE invoices DROP COLUMN DiscPrice'
dbExecute(dbcon, alterStatement)
alterStatement <- 'ALTER TABLE invoices ADD DiscPrice NUMERIC'
dbExecute(dbcon, alterStatement)
alterStatement <- 'ALTER TABLE invoices ADD DiscPrice NUMERIC DEFAULT Total'
dbExecute(dbcon, alterStatement)
alterStatement <- 'ALTER TABLE invoices DROP COLUMN DiscPrice'
dbExecute(dbcon, alterStatement)
alterStatement <- 'ALTER TABLE invoices ADD DiscPrice NUMERIC DEFAULT Total'
dbExecute(dbcon, alterStatement)
sqlQuery2 <- '
SELECT InvoiceId, CustomerId, Total, DiscPrice FROM invoices
WHERE DiscPrice IS NOT NULL
LIMIT 30'
rs4 <- dbGetQuery(dbcon,sqlQuery2)
rs4
alterStatement <- 'ALTER TABLE invoices DROP COLUMN DiscPrice'
dbExecute(dbcon, alterStatement)
alterStatement <- 'ALTER TABLE invoices ADD DiscPrice NUMERIC'
dbExecute(dbcon, alterStatement)
updateStatement <- '
UPDATE invoices
SET DiscPrice = Total * 0.9
WHERE InvoiceId IN(SELECT InvoiceId FROM invoice_items
GROUP BY InvoiceId
HAVING COUNT(*) > 5)
'
dbExecute(dbcon, updateStatement)
sqlQuery2 <- '
SELECT InvoiceId, CustomerId, Total, DiscPrice FROM invoices
WHERE DiscPrice IS NOT NULL
LIMIT 30'
rs4 <- dbGetQuery(dbcon,sqlQuery2)
rs4
sqlQuery2 <- '
SELECT InvoiceId, CustomerId, Total, DiscPrice FROM invoices
WHERE DiscPrice IS NOT NULL
'
rs4 <- dbGetQuery(dbcon,sqlQuery2)
rs4
sqlQuery2 <- '
SELECT InvoiceId, CustomerId, Total, DiscPrice FROM invoices
WHERE DiscPrice IS NOT NULL
LIMIT 30'
rs4 <- dbGetQuery(dbcon,sqlQuery2)
rs4
alterStatement <- 'ALTER TABLE invoices DROP COLUMN DiscPrice'
dbExecute(dbcon, alterStatement)
alterStatement <- 'ALTER TABLE invoices ADD DiscPrice NUMERIC'
dbExecute(dbcon, alterStatement)
updateStatement <- '
UPDATE invoices
SET DiscPrice = Total * 0.9
WHERE InvoiceId IN(SELECT InvoiceId FROM invoice_items
GROUP BY InvoiceId
HAVING COUNT(*) > 5)
'
dbExecute(dbcon, updateStatement)
sqlQuery2 <- '
SELECT InvoiceId, CustomerId, Total, DiscPrice FROM invoices
WHERE DiscPrice IS NOT NULL
LIMIT 30'
rs4 <- dbGetQuery(dbcon,sqlQuery2)
rs4
dbDisconnect(dbcon)
